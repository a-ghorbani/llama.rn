--- ggml-metal.m.orig	2025-03-12 21:45:16
+++ ggml-metal.m	2025-03-12 21:52:17
@@ -529,7 +529,11 @@ @implementation LMGGMLMetalClass
     NSBundle * bundle = [NSBundle bundleForClass:[LMGGMLMetalClass class]];
 #endif
 
-    NSString * path_lib = [bundle pathForResource:@"default" ofType:@"metallib"];
+    #if TARGET_OS_SIMULATOR
+        NSString * path_lib = [bundle pathForResource:@"ggml-llama-sim" ofType:@"metallib"];
+    #else
+        NSString * path_lib = [bundle pathForResource:@"ggml-llama" ofType:@"metallib"];
+    #endif
     if (path_lib == nil) {
         // Try to find the resource in the directory where the current binary located.
         NSString * current_binary = [[NSProcessInfo processInfo] arguments][0];
